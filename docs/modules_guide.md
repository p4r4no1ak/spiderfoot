# Modules Guide

SpiderFoot's power comes from its extensive collection of over **240 modules** that gather information from various sources and provide comprehensive intelligence gathering capabilities.

## Understanding Modules

### What are Modules?

Modules are plugins that:
- **Collect data** from specific sources (APIs, websites, databases, tools)
- **Process events** generated by other modules through the event correlation system
- **Generate new events** based on discovered information for downstream processing
- **Analyze and correlate** data across different sources with intelligent filtering

### Module Categories

#### DNS and Network (40+ modules)
- **DNS Resolution**: `sfp_dnsresolve`, `sfp_dnsraw`, `sfp_dnscommonsrv`
- **DNS Enumeration**: `sfp_dnsbrute`, `sfp_dnsdumpster`, `sfp_dnsdb`
- **SSL/TLS Analysis**: `sfp_sslcert`, `sfp_tool_testsslsh`
- **Port Scanning**: `sfp_portscan_tcp`, `sfp_tool_nmap`
- **Network Intelligence**: `sfp_bgpview`, `sfp_arin`, `sfp_ripe`

#### Threat Intelligence (60+ modules)
- **Reputation Services**: `sfp_virustotal`, `sfp_alienvault`, `sfp_threatcrowd`
- **Malware Analysis**: `sfp_hybrid_analysis`, `sfp_malware`, `sfp_vxvault`
- **Threat Feeds**: `sfp_abusech`, `sfp_emergingthreats`, `sfp_threatfox`
- **Blacklists**: `sfp_spamhaus`, `sfp_surbl`, `sfp_blocklist`
- **IOC Analysis**: `sfp_otx`, `sfp_maltiverse`, `sfp_threatminer`

#### Search Engines (30+ modules)
- **Web Search**: `sfp_googlesearch`, `sfp_bingsearch`, `sfp_duckduckgo`
- **Technical Search**: `sfp_shodan`, `sfp_censys`, `sfp_fofa`
- **Code Search**: `sfp_github`, `sfp_searchcode`, `sfp_grep_app`
- **Data Leaks**: `sfp_psbdmp`, `sfp_pastebin`, `sfp_intelx`

#### Social Media & People (25+ modules)
- **Profile Discovery**: `sfp_socialprofiles`, `sfp_accounts`, `sfp_social`
- **Professional Networks**: `sfp_fullcontact`, `sfp_clearbit`, `sfp_hunter`
- **Breach Data**: `sfp_haveibeenpwned`, `sfp_dehashed`, `sfp_leakcheck`
- **Communication**: `sfp_email`, `sfp_phone`, `sfp_skype`

#### External Tools (15+ modules)
- **Vulnerability Scanners**: `sfp_tool_nuclei`, `sfp_tool_wafw00f`
- **Web Analysis**: `sfp_tool_whatweb`, `sfp_tool_wappalyzer`
- **Security Tools**: `sfp_tool_snallygaster`, `sfp_tool_trufflehog`
- **Network Tools**: `sfp_tool_nmap`, `sfp_tool_onesixtyone`

## Module Types

### Passive Modules (Recommended for all scans)

Passive modules query external sources without directly interacting with your target:

```bash
# Safe reconnaissance modules
sfp_dnsresolve      # DNS resolution and mapping
sfp_whois           # WHOIS data collection  
sfp_threatcrowd     # Threat intelligence feeds
sfp_virustotal      # VirusTotal reputation checking
sfp_sslcert         # SSL certificate analysis
sfp_bgpview         # BGP and ASN information
sfp_social          # Social media profile discovery
sfp_haveibeenpwned  # Data breach checking
```
### Active Modules (Use with caution)

Active modules directly interact with your target and may generate logs:

```bash
# Interactive reconnaissance modules  
sfp_portscan_tcp    # TCP port scanning
sfp_spider          # Web content crawling
sfp_webheader       # HTTP header analysis
sfp_tool_nmap       # Nmap network scanning
sfp_tool_nuclei     # Vulnerability scanning
sfp_tool_whatweb    # Web technology fingerprinting
```

### Tool-Based Modules (Require external tools)

These modules wrap external security tools:

```bash
# External tool integration
sfp_tool_wappalyzer # Web technology detection
sfp_tool_wafw00f    # Web application firewall detection
sfp_tool_snallygaster # File leak detection
sfp_tool_trufflehog # Credential scanning
sfp_tool_dnstwist   # Domain squatting detection
sfp_tool_gobuster   # Directory/file brute forcing
```

## Core Modules Reference

### DNS and Network Modules

#### sfp_dnsresolve
- **Purpose**: Resolves domain names to IP addresses and performs reverse lookups
- **Data Sources**: Configurable DNS servers (default: system DNS)
- **Events Generated**: `IP_ADDRESS`, `DOMAIN_NAME`, `INTERNET_NAME`
- **Configuration Options**:
  ```bash
  # Custom DNS servers
  python sf.py -s example.com -t DOMAIN_NAME -o "_dns_servers=8.8.8.8,1.1.1.1"
  ```

#### sfp_whois  
- **Purpose**: WHOIS information lookup for domains and IP addresses
- **Data Sources**: Various WHOIS servers worldwide
- **Events Generated**: `PROVIDER_MAIL`, `PROVIDER_DNS`, `PHYSICAL_ADDRESS`, `RAW_RIR_DATA`
- **Use Cases**: Domain registration details, network ownership information

#### sfp_sslcert
- **Purpose**: SSL/TLS certificate analysis and validation
- **Data Sources**: Direct SSL connection to target
- **Events Generated**: `SSL_CERTIFICATE_ISSUED`, `SSL_CERTIFICATE_MISMATCH`, `SSL_CERTIFICATE_EXPIRED`
- **Features**: Certificate chain analysis, expiration checking, issuer validation

### Threat Intelligence Modules

#### sfp_virustotal
**Purpose**: VirusTotal API integration
**Configuration**:
```ini
sfp_virustotal.api_key = your_api_key
sfp_virustotal.verify = true
```
**Events Generated**: MALICIOUS_DOMAIN, MALICIOUS_IPADDR, THREAT_INTEL

#### sfp_threatcrowd
**Purpose**: ThreatCrowd threat intelligence
**Events Generated**: THREAT_INTEL, MALICIOUS_DOMAIN

## Module Selection Strategies

### By Use Case

#### Domain Reconnaissance
```bash
# Passive domain analysis
PASSIVE_DOMAIN="sfp_dnsresolve,sfp_whois,sfp_ssl,sfp_threatcrowd,sfp_virustotal"

# Active domain analysis
ACTIVE_DOMAIN="sfp_subdomain_enum,sfp_spider,sfp_webheader"
```

#### Network Assessment
```bash
# Network scanning
NETWORK_SCAN="sfp_portscan_tcp,sfp_banner,sfp_ssl,sfp_whois"

# Internet exposure
INTERNET_EXPOSURE="sfp_shodan,sfp_censys,sfp_binaryedge"
```

### By Risk Level

#### Low Risk (Passive Only)
```bash
LOW_RISK="sfp_dnsresolve,sfp_whois,sfp_ssl,sfp_threatcrowd,sfp_virustotal"
```

#### Medium Risk (Minimal Active)
```bash
MEDIUM_RISK="sfp_dnsresolve,sfp_whois,sfp_ssl,sfp_webheader,sfp_robots"
```

#### High Risk (Full Active)
```bash
HIGH_RISK="sfp_portscan_tcp,sfp_spider,sfp_subdomain_enum,sfp_dnstake"
```

## Module Configuration

### API Key Management

```ini
# Essential services
sfp_virustotal.api_key = your_virustotal_key
sfp_shodan.api_key = your_shodan_key
sfp_hunter.api_key = your_hunter_key

# Optional but recommended
sfp_securitytrails.api_key = your_securitytrails_key
sfp_passivetotal.api_key = your_passivetotal_key
```

### Performance Tuning

```ini
# DNS modules
sfp_dnsresolve.timeout = 30
sfp_dnsresolve.servers = 8.8.8.8,1.1.1.1

# HTTP modules
sfp_webheader.timeout = 30
sfp_spider.maxpages = 100

# Scanning modules
sfp_portscan_tcp.timeout = 5
sfp_portscan_tcp.maxports = 1000
```

## Best Practices

### Module Selection
1. **Start with passive modules** for initial reconnaissance
2. **Understand module behavior** before using active modules
3. **Consider target sensitivity** when choosing modules
4. **Monitor resource usage** during scans

### Performance Optimization
1. **Tune thread counts** based on system capabilities
2. **Set appropriate timeouts** for network operations
3. **Use module-specific limits** to control output volume
4. **Monitor API rate limits** to avoid blocking

For detailed module documentation, see the [Module Index](modules/index.md) or explore [Custom Module Development](developer/module_development.md).
