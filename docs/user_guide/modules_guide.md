# Modules Guide

SpiderFoot's power comes from its extensive collection of over 200 modules that gather information from various sources. This guide explains how modules work, how to configure them, and how to choose the right modules for your needs.

## Understanding Modules

### What are Modules?

Modules are plugins that:
- **Collect data** from specific sources (APIs, websites, databases)
- **Process events** generated by other modules
- **Generate new events** based on discovered information
- **Analyze and correlate** data across different sources

### Module Categories

#### DNS and Network
- **DNS Resolution**: Domain to IP mapping
- **Reverse DNS**: IP to domain mapping
- **DNS Records**: MX, TXT, NS, CNAME records
- **SSL Certificates**: Certificate analysis
- **Port Scanning**: Open port discovery
- **Banner Grabbing**: Service identification

#### Threat Intelligence
- **Reputation Services**: Domain/IP reputation
- **Malware Analysis**: Malware detection
- **Threat Feeds**: IOC matching
- **Blacklists**: Known bad actors
- **Security Vendors**: Multiple TI sources

#### Search Engines
- **Web Search**: Google, Bing, DuckDuckGo
- **Specialized Search**: Shodan, Censys
- **Code Search**: GitHub, GitLab
- **Academic Search**: Research databases

#### Social Media
- **Profile Discovery**: Social media accounts
- **Content Analysis**: Public posts and information
- **Network Mapping**: Social connections
- **Username Enumeration**: Cross-platform usernames

#### Data Breaches
- **Breach Databases**: Known data exposures
- **Email Verification**: Email in breaches
- **Credential Analysis**: Password exposures
- **Dark Web**: Underground markets

## Module Types

### Passive Modules

Passive modules query external sources without directly touching your target:

```bash
# Safe for any target
sfp_dnsresolve      # DNS queries
sfp_whois           # WHOIS lookups
sfp_threatcrowd     # Threat intelligence
sfp_virustotal      # VirusTotal queries
sfp_sslcert         # SSL certificate info
```

**Characteristics:**
- No direct contact with target
- Safe for production environments
- Cannot be detected by target
- Often require API keys

### Active Modules

Active modules directly interact with your target:

```bash
# Use with caution
sfp_portscan_tcp    # Port scanning
sfp_spider          # Web crawling
sfp_subdomain_enum  # Active subdomain enumeration
sfp_webheader       # HTTP header analysis
sfp_dnstake         # DNS takeover detection
```

**Characteristics:**
- Direct interaction with target
- May trigger security alerts
- Can impact target performance
- Require proper authorization

### Footprinting Modules

Modules that expand the attack surface:

```bash
sfp_subdomain_enum  # Find subdomains
sfp_emailformat     # Discover email patterns
sfp_social          # Social media profiles
sfp_github          # Code repositories
```

## Core Modules Reference

### DNS and Network Modules

#### sfp_dnsresolve
**Purpose**: Resolves domain names to IP addresses
**Configuration**: 
```ini
sfp_dnsresolve.timeout = 30
sfp_dnsresolve.servers = 8.8.8.8,1.1.1.1
```
**Events Generated**: IP_ADDRESS, DOMAIN_NAME
**Usage**: Essential for all domain-based investigations

#### sfp_whois
**Purpose**: WHOIS information lookup
**Configuration**:
```ini
sfp_whois.timeout = 30
sfp_whois.verify = true
```
**Events Generated**: PROVIDER_MAIL, PROVIDER_DNS, PHYSICAL_ADDRESS
**Usage**: Domain registration and ownership information

#### sfp_ssl
**Purpose**: SSL certificate analysis
**Configuration**:
```ini
sfp_ssl.timeout = 30
sfp_ssl.verify_chains = true
```
**Events Generated**: SSL_CERTIFICATE_ISSUED, SSL_CERTIFICATE_MISMATCH
**Usage**: Certificate validation and security analysis

#### sfp_portscan_tcp
**Purpose**: TCP port scanning
**Configuration**:
```ini
sfp_portscan_tcp.timeout = 5
sfp_portscan_tcp.maxports = 1000
sfp_portscan_tcp.randomize = true
```
**Events Generated**: TCP_PORT_OPEN, TCP_PORT_OPEN_BANNER
**Usage**: Network service discovery

### Threat Intelligence Modules

#### sfp_virustotal
**Purpose**: VirusTotal API integration
**Configuration**:
```ini
sfp_virustotal.api_key = your_api_key
sfp_virustotal.verify = true
sfp_virustotal.delay = 15
```
**Events Generated**: MALICIOUS_DOMAIN, MALICIOUS_IPADDR, THREAT_INTEL
**Usage**: Malware and threat detection

#### sfp_threatcrowd
**Purpose**: ThreatCrowd threat intelligence
**Configuration**:
```ini
sfp_threatcrowd.verify = true
sfp_threatcrowd.cohostsamedomain = false
```
**Events Generated**: THREAT_INTEL, MALICIOUS_DOMAIN
**Usage**: Free threat intelligence source

#### sfp_alienvault
**Purpose**: AlienVault OTX integration
**Configuration**:
```ini
sfp_alienvault.api_key = your_api_key
sfp_alienvault.verify = true
```
**Events Generated**: THREAT_INTEL, MALICIOUS_IPADDR
**Usage**: Comprehensive threat intelligence

### Search Engine Modules

#### sfp_google
**Purpose**: Google search results
**Configuration**:
```ini
sfp_google.api_key = your_api_key
sfp_google.cse_id = your_cse_id
```
**Events Generated**: SEARCH_ENGINE_WEB_CONTENT, LINKED_URL_INTERNAL
**Usage**: Web presence discovery

#### sfp_shodan
**Purpose**: Shodan internet device search
**Configuration**:
```ini
sfp_shodan.api_key = your_api_key
sfp_shodan.verify = true
sfp_shodan.maxpages = 10
```
**Events Generated**: TCP_PORT_OPEN, WEBSERVER_BANNER, OPERATING_SYSTEM
**Usage**: Internet-facing device discovery

#### sfp_github
**Purpose**: GitHub repository search
**Configuration**:
```ini
sfp_github.api_key = your_api_key
sfp_github.verify = true
```
**Events Generated**: PUBLIC_CODE_REPO, EMAILADDR, HUMAN_NAME
**Usage**: Code repository and developer information

### Social Media Modules

#### sfp_social
**Purpose**: Social media profile discovery
**Configuration**:
```ini
sfp_social.verify = true
sfp_social.timeout = 30
```
**Events Generated**: SOCIAL_MEDIA, USERNAME, HUMAN_NAME
**Usage**: Social media presence mapping

#### sfp_twitter
**Purpose**: Twitter account enumeration
**Configuration**:
```ini
sfp_twitter.api_key = your_api_key
sfp_twitter.verify = true
```
**Events Generated**: SOCIAL_MEDIA, USERNAME, EMAILADDR
**Usage**: Twitter presence and information

### Data Breach Modules

#### sfp_haveibeen
**Purpose**: HaveIBeenPwned integration
**Configuration**:
```ini
sfp_haveibeen.api_key = your_api_key
sfp_haveibeen.verify = true
```
**Events Generated**: EMAILADDR_COMPROMISED, BREACH_DATA
**Usage**: Email address breach checking

#### sfp_hunter
**Purpose**: Hunter.io email discovery
**Configuration**:
```ini
sfp_hunter.api_key = your_api_key
sfp_hunter.verify = true
```
**Events Generated**: EMAILADDR, EMAILADDR_GENERIC
**Usage**: Email address enumeration

## Module Selection Strategies

### By Use Case

#### Domain Reconnaissance
```bash
# Passive domain analysis
PASSIVE_DOMAIN="sfp_dnsresolve,sfp_whois,sfp_ssl,sfp_threatcrowd,sfp_virustotal"

# Active domain analysis
ACTIVE_DOMAIN="sfp_subdomain_enum,sfp_spider,sfp_webheader,sfp_dnstake"

# Comprehensive domain analysis
COMPREHENSIVE_DOMAIN="$PASSIVE_DOMAIN,$ACTIVE_DOMAIN"
```

#### Network Assessment
```bash
# Network scanning
NETWORK_SCAN="sfp_portscan_tcp,sfp_banner,sfp_ssl,sfp_whois"

# Internet exposure
INTERNET_EXPOSURE="sfp_shodan,sfp_censys,sfp_binaryedge"

# Network intelligence
NETWORK_INTEL="sfp_bgp,sfp_asn,sfp_netblocks"
```

#### Threat Hunting
```bash
# Threat intelligence
THREAT_INTEL="sfp_virustotal,sfp_threatcrowd,sfp_alienvault,sfp_malware"

# Reputation checking
REPUTATION="sfp_reputation,sfp_blacklist,sfp_tor"

# Breach analysis
BREACH_CHECK="sfp_haveibeen,sfp_breachcomp,sfp_leak"
```

#### OSINT Investigation
```bash
# Social media
SOCIAL_MEDIA="sfp_social,sfp_twitter,sfp_linkedin,sfp_instagram"

# Search engines
SEARCH_ENGINES="sfp_google,sfp_bing,sfp_duckduckgo,sfp_yandex"

# Code repositories
CODE_REPOS="sfp_github,sfp_gitlab,sfp_bitbucket"
```

### By Risk Level

#### Low Risk (Passive Only)
```bash
LOW_RISK="sfp_dnsresolve,sfp_whois,sfp_ssl,sfp_threatcrowd,sfp_virustotal,sfp_shodan_api"
```

#### Medium Risk (Minimal Active)
```bash
MEDIUM_RISK="sfp_dnsresolve,sfp_whois,sfp_ssl,sfp_webheader,sfp_robots,sfp_threatcrowd"
```

#### High Risk (Full Active)
```bash
HIGH_RISK="sfp_portscan_tcp,sfp_spider,sfp_subdomain_enum,sfp_dnstake,sfp_fuzzer"
```

## Module Configuration

### API Key Management

#### Required API Keys
```ini
# Essential services
sfp_virustotal.api_key = your_virustotal_key
sfp_shodan.api_key = your_shodan_key
sfp_hunter.api_key = your_hunter_key

# Optional but recommended
sfp_securitytrails.api_key = your_securitytrails_key
sfp_passivetotal.api_key = your_passivetotal_key
sfp_greynoise.api_key = your_greynoise_key
```

#### Free API Sources
- **ThreatCrowd**: No API key required
- **HackerTarget**: Free tier available
- **DNS Dumpster**: No registration required
- **Certificate Transparency**: Free access

### Performance Tuning

#### Module-Specific Settings
```ini
# DNS modules
sfp_dnsresolve.timeout = 30
sfp_dnsresolve.servers = 8.8.8.8,1.1.1.1

# HTTP modules
sfp_webheader.timeout = 30
sfp_spider.maxpages = 100

# Scanning modules
sfp_portscan_tcp.timeout = 5
sfp_portscan_tcp.maxports = 1000

# API modules
sfp_virustotal.delay = 15
sfp_shodan.maxpages = 10
```

#### Global Performance Settings
```ini
# Thread management
_maxthreads = 10
_timeout = 300

# Rate limiting
_delay = 1
_maxpages = 100

# Memory management
_maxresults = 50000
```

## Module Development

### Custom Module Structure

```python
from spiderfoot import SpiderFootPlugin, SpiderFootEvent

class sfp_custom_module(SpiderFootPlugin):
    meta = {
        'name': "Custom Module",
        'summary': "Description of what the module does",
        'flags': [""],
        'useCases': [""],
        'categories': [""],
        'dataSource': {
            'website': "https://example.com",
            'model': "FREE_NOAUTH_UNLIMITED"
        }
    }

    opts = {
        'timeout': 30,
        'verify': True
    }

    optdescs = {
        'timeout': "Timeout for requests",
        'verify': "Verify hostnames resolve"
    }

    def setup(self, sfc, userOpts=dict()):
        self.sf = sfc
        self.opts.update(userOpts)

    def watchedEvents(self):
        return ["DOMAIN_NAME"]

    def producedEvents(self):
        return ["CUSTOM_EVENT_TYPE"]

    def handleEvent(self, event):
        # Module logic here
        pass
```

### Testing Custom Modules

```bash
# Test module syntax
python -m py_compile modules/sfp_custom_module.py

# Test module functionality
python sf.py -s example.com -t DOMAIN_NAME -m sfp_custom_module -v

# Debug module
python sf.py -s example.com -t DOMAIN_NAME -m sfp_custom_module --debug
```

## Troubleshooting Modules

### Common Issues

#### Module Not Loading
```bash
# Check module syntax
python -m py_compile modules/sfp_module_name.py

# Verify module location
ls -la modules/ | grep sfp_module_name

# Check module permissions
chmod 644 modules/sfp_module_name.py
```

#### API Key Issues
```bash
# Test API key
python sf.py --test-modules

# Check API key format
# Verify key has proper permissions
# Check rate limits
```

#### Performance Issues
```bash
# Increase timeouts
sfp_module.timeout = 60

# Reduce concurrent requests
_maxthreads = 3

# Add delays
sfp_module.delay = 5
```

### Debugging Tools

```bash
# Verbose output
python sf.py -s example.com -t DOMAIN_NAME -m sfp_module -v

# Debug mode
python sf.py -s example.com -t DOMAIN_NAME -m sfp_module --debug

# Module testing
python sf.py -M sfp_module

# Network testing
python sf.py -s httpbin.org -t DOMAIN_NAME -m sfp_webheader -v
```

## Best Practices

### Module Selection
1. **Start Passive**: Begin with passive modules
2. **Understand Impact**: Know which modules are active
3. **Consider Target**: Choose appropriate modules for target type
4. **Monitor Performance**: Watch resource usage
5. **Review Results**: Analyze output quality

### API Management
1. **Secure Storage**: Protect API keys
2. **Rate Limiting**: Respect service limits
3. **Key Rotation**: Regularly update keys
4. **Monitor Usage**: Track API consumption
5. **Backup Keys**: Maintain key backups

### Performance Optimization
1. **Thread Tuning**: Adjust based on system resources
2. **Timeout Management**: Set appropriate timeouts
3. **Result Limiting**: Control output volume
4. **Module Ordering**: Optimize execution sequence
5. **Resource Monitoring**: Watch system resources

Ready to dive deeper? Explore [Custom Module Development](../developer/module_development.md) or check out the [API Reference](../api/rest_api.md).
